USE master;
GO

IF NOT EXISTS (
		SELECT name
		FROM sysdatabases
		WHERE name = 'GenesysStaging'
		)
BEGIN
	CREATE DATABASE GenesysStaging;
END
GO


IF NOT EXISTS (
		SELECT name
		FROM sys.server_principals
		WHERE name = 'GenesysStagingUser'
		)
BEGIN
	CREATE LOGIN [GenesysStagingUser]
		WITH PASSWORD = 'GenesysStaging202007';
END

USE GenesysStaging;
GO

IF NOT EXISTS (
		SELECT *
		FROM sys.database_principals
		WHERE name = 'GenesysStaging'
		)
BEGIN
	CREATE USER [GenesysStagingUser]
	FOR LOGIN [GenesysStagingUser]

	EXEC sp_addrolemember 'db_owner'
		, 'GenesysStagingUser'
END;
GO

-- Create Oppty table
IF EXISTS (
		SELECT name
		FROM sysobjects
		WHERE name = 'SFDC_Oppty'
			AND type = 'U'
		)
BEGIN
	DROP TABLE dbo.SFDC_Oppty;
END
GO

create table SFDC_Oppty
(
    [Opportunity ID]                           varchar(18),
    Deleted                                    bit,
    [Account ID]                               varchar(18),
    [Record Type ID]                           varchar(18),
    Private                                    bit,
    Name                                       varchar(120),
    Description                                text,
    Stage                                      varchar(40),
    [ACV Variance]                             varchar(100),
    [Probability (%)]                          varchar(100),
    [Weighted Forecast Revenue]                varchar(100),
    Quantity                                   float,
    [Close Date]                               datetime,
    [Opportunity Type]                         varchar(40),
    [DO NOT USE: Next Step]                    varchar(255),
    [Lead Source]                              varchar(40),
    Closed                                     bit,
    Won                                        bit,
    [Forecast Category]                        varchar(40),
    [Forecast Category_1]                      varchar(40),
    [Opportunity Currency]                     varchar(3),
    [Campaign ID]                              varchar(18),
    [Has Line Item]                            bit,
    [Price Book ID]                            varchar(18),
    [Owner ID]                                 varchar(18),
    [Created Date]                             datetime,
    [Created By ID]                            varchar(18),
    [Last Modified Date]                       datetime,
    [Last Modified By ID]                      varchar(18),
    [System Modstamp]                          datetime,
    [Last Activity]                            datetime,
    [Fiscal Quarter]                           int,
    [Fiscal Year]                              int,
    [Fiscal Period]                            varchar(6),
    [Last Viewed Date]                         datetime,
    [Last Referenced Date]                     datetime,
    [Quote ID]                                 varchar(18),
    [Plan]                                     varchar(18),
    [Has Open Activity]                        bit,
    [Has Overdue Task]                         bit,
    [Solution Taxonomy]                        varchar(4099),
    [Finance Field History]                    text,
    [Bill To Status Dev]                       varchar(255),
    Product                                    varchar(255),
    Competitor                                 varchar(4099),
    [Reason Lost]                              varchar(255),
    [Reconciliation Notes]                     varchar(255),
    [Routed Through Round Robin]               bit,
    [Opportunity Number]                       varchar(30),
    [Reason Won]                               varchar(255),
    [Renewal Results]                          varchar(255),
    [Record Type Name]                         varchar(1300),
    [Ramp Month]                               float,
    [Finance Approval]                         text,
    [Project Name]                             varchar(80),
    [Fully Ramped Currency Quota Value]        varchar(100),
    [# of Times Pushed Out]                    float,
    [SysAdmin Plan]                            varchar(10),
    [Date Assigned to Partner]                 datetime,
    [Opportunity Month]                        varchar(1300),
    [Is Deal Registration]                     bit,
    [Currency Quota Value]                     varchar(100),
    [Notify RV Member]                         bit,
    [Quota Start Date]                         datetime,
    [Partner Last Modified Date]               datetime,
    [Parent Payment Profile ID]                varchar(16),
    [Lead Creation Date]                       datetime,
    [Partner Opportunity Acceptance]           varchar(255),
    [RV Account]                               varchar(18),
    [Commissionable ARR]                       varchar(100),
    Forecast                                   varchar(255),
    [RV Member]                                varchar(18),
    [Deal Registration Details]                text,
    [Commissionable ARR Override]              varchar(100),
    [Other Product Interest]                   text,
    [Signatory Email]                          varchar(1300),
    [Sent Back to Sales Reason]                varchar(255),
    [Lead Source Bucket]                       varchar(1300),
    OpsCon                                     varchar(1300),
    [Subscription End Date]                    datetime,
    Products                                   varchar(4099),
    [Bill To Status]                           varchar(255),
    [Subscription Start Date]                  datetime,
    [Billing Contact Name]                     varchar(100),
    [Billing Contact Email]                    varchar(80),
    [Non Profit Tax ID (EIN)]                  varchar(25),
    [Non Profit]                               bit,
    Signatory                                  varchar(1300),
    [Signatory Last Name]                      varchar(1300),
    [New User Limit]                           float,
    Reseller                                   bit,
    [Territory Assignment at Close]            varchar(18),
    [Notes to Finance]                         varchar(255),
    [Management Exception]                     text,
    [Owner Segment]                            varchar(1300),
    [Next Step]                                text,
    [Reason Lost Details]                      text,
    [Marketo Opportunity Analysis]             varchar(1300),
    [Owner Division at Close]                  varchar(255),
    [PO Number]                                varchar(55),
    [Owner Segment at Close]                   varchar(255),
    [Billing Contact Phone]                    varchar(40),
    [Order Hold Warning]                       varchar(1300),
    [Billing Address]                          varchar(255),
    [Bill To]                                  bit,
    [Reason Won Details]                       text,
    [Opportunity Count]                        float,
    [Domain Lookup]                            varchar(18),
    [Date PO Expected]                         datetime,
    [Additional Information for Accounting]    varchar(1000),
    [SysAdmin Email Address]                   varchar(80),
    [Quota ACV Override]                       varchar(100),
    [Quota ACV]                                varchar(100),
    [PO Required?]                             varchar(255),
    [Bill To CC Name]                          varchar(100),
    [Bill to Address]                          varchar(255),
    [Exclude from Future Expansion]            bit,
    [Booking ACV]                              varchar(100),
    [Previous ARR]                             varchar(100),
    [Pending Close Date]                       datetime,
    [Closed Won Date]                          datetime,
    [Record Type]                              varchar(20),
    [Bill to City]                             varchar(50),
    [Bill to Country Code]                     varchar(50),
    [Bill to Post Code]                        varchar(50),
    [Bill to Region Code]                      varchar(50),
    [New Payment Term Annual]                  varchar(20),
    [Old User Limit]                           float,
    Status                                     varchar(1300),
    [First Opp on Account]                     bit,
    [Is Pipeline Opp]                          bit,
    [Current Month Opp]                        bit,
    [Commissionable One-Time Total]            varchar(100),
    [Commissionable One-Time Total Override]   varchar(100),
    [Services ACV]                             varchar(100),
    [Services Completed]                       bit,
    [Services Delivered ACV]                   varchar(100),
    [Service Hours Estimate]                   float,
    [Consolidation ARR]                        varchar(100),
    [Docusign Template ID]                     varchar(1300),
    [Platform ACV]                             varchar(100),
    [License ACV]                              varchar(100),
    [Sent Back to Sales Details]               text,
    [Date Sent Back to Sales]                  datetime,
    [Design Desk Pack Count]                   varchar(255),
    [Add to Deal Desk]                         bit,
    [Manager at Close ID]                      varchar(18),
    [Reporting SFDC Role]                      varchar(1300),
    [Reporting SFDC Team]                      varchar(1300),
    [Account Customer Success Email]           varchar(1300),
    [Account Customer Success Name]            varchar(1300),
    [Reporting SFDC Manager]                   varchar(1300),
    [Closed Won in Past 30 Days]               bit,
    [Strategic Product Bonus]                  float,
    [Strategic Sales Process]                  varchar(4099),
    [Renewal Date]                             datetime,
    [Handover - Primary Contact Name]          varchar(50),
    [Handover - Primary Contact Title]         varchar(100),
    [Handover - Primary Contact Email]         varchar(100),
    [Primary Use Case]                         varchar(255),
    [Reseller Opportunity]                     varchar(1300),
    [Primary Use Case and Next Steps]          text,
    [Manager Email Address]                    varchar(80),
    [Owner Role at Close]                      varchar(50),
    [Services - Signer Name]                   varchar(50),
    [Services - Signer Email]                  varchar(100),
    [Services - Signer Phone]                  varchar(25),
    [Services - Signing Method]                varchar(255),
    [Handover - Primary Contact Phone]         varchar(25),
    [Number of Users involved]                 float,
    [Primary Goals/Objectives]                 text,
    [Current Process]                          varchar(2000),
    [Budget/Timeline]                          varchar(1000),
    [Additional Comments]                      text,
    [Scoping Options]                          varchar(255),
    [Onsite Location]                          varchar(255),
    Currency                                   varchar(255),
    [Billing Street]                           varchar(255),
    [Billing Street 2]                         varchar(255),
    [Billing City]                             varchar(255),
    [Billing State/Region]                     varchar(255),
    [Billing Zip Code]                         varchar(100),
    [Billing Country]                          varchar(255),
    [Dashboard Seats Enabled]                  varchar(255),
    [Dashboard Users to Enable]                text,
    [Customer Success at Close]                varchar(50),
    [Account Owner at Close]                   varchar(50),
    [Reseller Account]                         varchar(18),
    [Customer Success Email Address]           varchar(80),
    [Sales Engineer]                           varchar(18),
    [Currency Services Quota Value]            varchar(100),
    [SMB Pack]                                 bit,
    [Time Trigger 05]                          datetime,
    [Bump Field]                               bit,
    [Total Bookings]                           varchar(100),
    StatusView                                 bit,
    [Smartsheet Control Center]                bit,
    [Created By Role]                          varchar(1300),
    [Design Desk Code Generated]               varchar(20),
    [Deal Greater Than $5K]                    bit,
    [Launch Package]                           bit,
    [Quote Request Status]                     varchar(255),
    [Owner Role Name]                          varchar(1300),
    [Rapid Deployment]                         varchar(255),
    [SOW Template ID]                          varchar(1300),
    [Owner Start Date]                         datetime,
    [SOW Background]                           text,
    [SOW Scope of Work]                        text,
    [Key Deals]                                bit,
    [Assign Free Onboarding]                   bit,
    [SDR Rejected Reason]                      varchar(255),
    [BAM Alert Owner]                          varchar(1300),
    [Order Management Assisted]                bit,
    [SDR Attribution]                          varchar(18),
    [Manager at Close]                         varchar(50),
    [DocuSign Days Until Expiration]           float,
    [Customer Success]                         varchar(18),
    [SDR Status]                               varchar(255),
    [Subscription Term]                        varchar(255),
    [Closed Quarter]                           varchar(1300),
    [Channel Sales Status]                     varchar(255),
    [Owner Email]                              varchar(1300),
    [On Ramp]                                  bit,
    [Training Language]                        varchar(255),
    [Owner Manager]                            varchar(1300),
    [JIRA Environment]                         varchar(255),
    [Owner Division]                           varchar(1300),
    Interest                                   text,
    Evaluation                                 text,
    Decision                                   text,
    Risks                                      text,
    [Negotiation Strategy (Incentives)]        text,
    [Last update to Next Steps]                datetime,
    Purchase                                   text,
    [Pricing/Scope Agreement]                  varchar(255),
    [Security Requirement]                     varchar(255),
    [Legal Requirement]                        varchar(255),
    [Plan Integration Status]                  varchar(255),
    [Deal Greater Than $50K]                   bit,
    [Big Deal Use Case]                        text,
    [ARR Variance Override]                    varchar(100),
    [ARR Variance]                             varchar(100),
    [Agreement Type]                           varchar(255),
    [Bill To Customer ID]                      varchar(80),
    [Changing Subscription Plan]               float,
    [Close Date (Formatted)]                   varchar(1300),
    [18 Digit ID]                              varchar(1300),
    [Sales Engineer Name]                      varchar(1300),
    [Count of Products]                        float,
    [Current Related Plan Type]                varchar(1300),
    [End Customer ID]                          varchar(80),
    [Exclude from NetSuite Integration]        bit,
    [External ID]                              varchar(80),
    Memo                                       varchar(255),
    [NetSuite SO ID]                           varchar(80),
    [Open Renewal Opportunity]                 float,
    [Opportunity Estimated Total Due]          varchar(1300),
    [Opportunity One-Time Total (Formatted)]   varchar(1300),
    [Opportunity Recurring Total (Formatted)]  varchar(1300),
    [Opportunity Total Due (Formatted)]        varchar(1300),
    [Order Hold]                               bit,
    [Payment Terms - DocuSign]                 varchar(1300),
    [Payment Terms]                            varchar(255),
    [Previous License ARR]                     varchar(100),
    [Proration/Credit Calculation]             varchar(100),
    [Proration/Credit Language]                varchar(1300),
    [Proration/Credit Override]                varchar(100),
    [Reset Plan Start Date]                    bit,
    [Shipping Address]                         varchar(255),
    [Add a Signature Block]                    bit,
    [Opportunity One-Time Total (DocuSign)]    varchar(100),
    [Opportunity One-Time Total]               varchar(100),
    [Opportunity Recurring Total (DocuSign)]   varchar(100),
    [Opportunity Recurring Total]              varchar(100),
    [Opportunity Subscription Discount]        varchar(100),
    [Primary Subscription Products]            float,
    [Current Month Opp (Non-Bill To)]          float,
    [Opportunity Owner Name]                   varchar(1300),
    [Account Name Text]                        varchar(1300),
    [New Plan ARR]                             varchar(100),
    [Counter-Signature First Name (DocuSign)]  varchar(1300),
    [Counter-Signature Last Name (DocuSign)]   varchar(1300),
    [Counter-Signature Email (DocuSign)]       varchar(1300),
    [Plan Next Renewal Date]                   datetime,
    [Opportunity Recurring Total - Discounts]  varchar(100),
    [ARR Variance History]                     varchar(100),
    HIPAA                                      varchar(1300),
    [Override Fat Finger Validation]           bit,
    [Reseller Margin Override]                 varchar(100),
    [Total Bookings Greater than 3K]           bit,
    [Strategic Opportunity Grouping]           varchar(1300),
    [Strategic Opportunity Role Grouping]      varchar(1300),
    [Proration/Credit Calculation 2]           varchar(100),
    [Count of Quotes]                          float,
    [SDR Notes]                                text,
    [Added Plan ARR]                           varchar(1300),
    [CoE Order Form Language]                  varchar(1300),
    [Early Renewal]                            bit,
    [OpsCon Activated Date/Time]               datetime,
    [Order Form Language]                      varchar(1300),
    [Services City]                            varchar(255),
    [Services Country]                         varchar(255),
    [Services State/Region]                    varchar(255),
    [Services Street 2]                        varchar(255),
    [Services Street]                          varchar(255),
    [Services Zip Code]                        varchar(100),
    [Subscription Action]                      varchar(1300),
    [Subscription Term (DocuSign)]             varchar(1300),
    [Count of Licensing Products]              float,
    [Opportunity Licensing ARR]                varchar(100),
    [Opportunity Subscription Discount (Form)] varchar(1300),
    [Strategic Opportunity Division]           varchar(1300),
    [Plan is on True Up]                       bit,
    [Proactive, Reactive, Multithread]         varchar(255),
    [Group]                                    varchar(18),
    IsParentOpportunityServices                bit,
    [Is Change Request]                        bit,
    [Is Services Opportunity]                  bit,
    [Parent Opportunity]                       varchar(18),
    Practice                                   varchar(18),
    [Pre-Billed Amount]                        varchar(100),
    [Pre-Billed Amount_1]                      varchar(100),
    [Primary Project]                          varchar(18),
    [Rate Card Discount Limit]                 float,
    [Rate Card Percentage Discount]            varchar(100),
    [Rate Card Set]                            varchar(18),
    Region                                     varchar(18),
    [Services Attached % From Products]        varchar(100),
    [Services Attached From Products]          varchar(100),
    [XXX Batch Process]                        varchar(18),
    [Forecast Curve]                           varchar(18),
    [Total Bookings Greater than 3K Override]  bit,
    [CO Consulting Project]                    varchar(18),
    [CO Onboarding Project]                    varchar(18),
    [Consulting Project]                       varchar(18),
    [Onboarding Project]                       varchar(18),
    [NetSuite Services Customer Id]            varchar(100),
    [Open Opportunity with Positive ARR]       float,
    [Joint Engagement Plan In Place]           bit,
    [Big Deal Use Case Override]               bit,
    [Is Current User]                          bit,
    [SDR Manager Email]                        varchar(80),
    [Discount Approval Status]                 varchar(255),
    [Secondary Scoper]                         varchar(18),
    [Primary Scoper]                           varchar(18),
    [Opportunity Discount Amount]              varchar(100),
    [Opportunity Discount Percent]             varchar(100),
    [Opportunity Recurring Discount > Plan]    bit,
    [Opportunity Undiscounted Recurring Total] varchar(100),
    [Weighted ARR]                             varchar(100),
    [Discount Approval Level]                  varchar(1300),
    [Account Name (Formatted for JavaScript)]  varchar(1300),
    [Temp Fire]                                bit,
    [Has Consulting Project]                   bit,
    [USD ARR Variance]                         float,
    [Count of Consultant Team Members]         float,
    [NetSuite SO Document Number]              varchar(80),
    [SSR Bonus]                                varchar(100),
    [CS Attribution]                           varchar(18),
    [Legal Opt-Out]                            bit,
    [Opportunity Review]                       bit,
    [Amended Contract]                         varchar(18),
    Contracted                                 bit,
    [Create Contracted Prices]                 bit,
    [Order Group ID]                           varchar(255),
    Ordered                                    bit,
    [Primary Quote]                            varchar(18),
    [Quote Pricebook Id]                       varchar(18),
    Renewal                                    bit,
    [Renewed Contract]                         varchar(18),
    [Approval Status]                          varchar(255),
    [Original Contract ARR]                    varchar(100),
    [Primary Quote ARR]                        varchar(100),
    [Approval Step]                            float,
    [Non-Recurring Revenue Total]              varchar(100),
    [Non Profit Pricing]                       bit,
    [Government Pricing]                       bit,
    [Fed. Gov. Sub Class]                      varchar(1300),
    Approver                                   varchar(18),
    [Step Approved]                            bit,
    [Submitted Date]                           datetime,
    [Submitted User]                           varchar(18),
    [Renewal Billing Exception Date]           datetime,
    [Renewal Billing Exception Status]         varchar(255),
    IsfromCPQWrapper                           bit,
    [Reseller Discount Percentage]             varchar(100),
    [Reseller Renewal Discount Percentage]     varchar(100),
    [Reseller Account Set]                     bit,
    [Amendment Contract Reseller]              varchar(1300),
    [Create Renewal Quote]                     bit,
    [Reseller Account Name]                    varchar(1300),
    [BI Sequence ID]                           varchar(50),
    [auto renewed]                             bit
)
go

IF EXISTS (
		SELECT name
		FROM sysobjects
		WHERE name = 'SFDC_OpptyLineItem'
			AND type = 'U'
		)
BEGIN
	DROP TABLE dbo.SFDC_OpptyLineItem;
END
GO

create table SFDC_OpptyLineItem
(
    [Line Item ID]                             varchar(18),
    [Opportunity ID]                           varchar(18),
    [Sort Order]                               int,
    [Price Book Entry ID]                      varchar(18),
    [Product ID]                               varchar(18),
    [Product Code]                             varchar(255),
    [Opportunity Product Name]                 varchar(376),
    [Currency ISO Code]                        varchar(3),
    Quantity                                   float,
    Discount                                   varchar(100),
    Subtotal                                   varchar(100),
    [Total Price]                              varchar(100),
    [Sales Price]                              varchar(100),
    [List Price]                               varchar(100),
    Date                                       datetime,
    [Line Description]                         varchar(255),
    [Created Date]                             datetime,
    [Created By ID]                            varchar(18),
    [Last Modified Date]                       datetime,
    [Last Modified By ID]                      varchar(18),
    [System Modstamp]                          datetime,
    Deleted                                    bit,
    [Billing Frequency]                        varchar(1300),
    Category                                   varchar(1300),
    [Changing Subscription Plan Checkbox]      bit,
    [Changing Subscription Plan]               float,
    [Discount Reason]                          varchar(255),
    Discount_1                                 varchar(100),
    [Expiration Date]                          datetime,
    [Is Design Desk]                           bit,
    [Is Recurring Checkbox]                    bit,
    [Is SFDC Connector]                        bit,
    [Netsuite Line Item ID]                    varchar(80),
    [Netsuite SO ID]                           varchar(80),
    [Opportunity Closed Won]                   bit,
    [Primary Subscription]                     bit,
    [Product Is Recurring]                     bit,
    [Product Notes for Future]                 text,
    [Product Plan Type]                        varchar(1300),
    [Prorated Price to Plan Renewal Date]      float,
    [Related SKU]                              varchar(18),
    [Rev Rec End Date]                         datetime,
    [Rev Rec Start Date]                       datetime,
    [SOW Product]                              varchar(10),
    [Sales Price (Formatted)]                  varchar(1300),
    [Total (Formatted)]                        varchar(1300),
    [Training Handover Or Consulting Pipeline] varchar(1300),
    [Is CoE]                                   bit,
    [Is JIRA Connector]                        bit,
    [Is SCC]                                   bit,
    [Applies to Opportunity ARR Total]         bit,
    [Opportunity Product Compilation]          varchar(1300),
    [Changing Subscription Plan Override]      bit,
    [List Price Total]                         varchar(100),
    Provisioned                                bit,
    [CSM Email]                                varchar(80),
    [Subscription Discount]                    bit,
    [Opportunity Owner Email]                  varchar(80),
    [Sync to CoE Provisioning Sheet]           bit,
    Licensing                                  bit,
    [Number of CoE Seats]                      float,
    [Product Name]                             varchar(1300),
    [Percent of Licensing]                     varchar(100),
    [Proration Override]                       float,
    [Renewal Date at OpsCon Activated]         datetime,
    [Reseller Margin]                          varchar(100),
    [Prorated Price (Formatted)]               float,
    [Added To Project]                         bit,
    IsServicesProductLine                      bit,
    [18 Digit ID]                              varchar(1300),
    [Assignment IDs]                           text,
    Consumed                                   varchar(255),
    [Milestone IDs]                            text,
    [Price Book Entry ID_1]                    varchar(1300),
    [Opportunity Consulting Project Code]      varchar(1300),
    [Sync to Pro Desk Provisioning Sheet]      bit,
    [Provisioned in Acuity]                    bit,
    [Reseller Margin Override]                 varchar(100),
    [Sync to Services Sales Tracker]           bit,
    [Strategic Product Bonus]                  bit,
    [SSR Bonus]                                bit,
    [Related Milestone]                        varchar(18),
    [USD Total Price]                          float,
    [Parent ID]                                varchar(18),
    [Quote Line]                               varchar(18),
    [Subscription Type]                        varchar(255),
    [Approval Status]                          varchar(255)
)
go

